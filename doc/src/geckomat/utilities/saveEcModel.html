<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of saveEcModel</title>
  <meta name="keywords" content="saveEcModel">
  <meta name="description" content="saveECmodel">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../index.html">Home</a> &gt;  <a href="#">src</a> &gt; <a href="#">geckomat</a> &gt; <a href="index.html">utilities</a> &gt; saveEcModel.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../index.html"><img alt="<" border="0" src="../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for src\geckomat\utilities&nbsp;<img alt=">" border="0" src="../../../right.png"></a></td></tr></table>-->

<h1>saveEcModel
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>saveECmodel</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function saveECmodel(model,modelAdapter,format,filename) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> saveECmodel
   Saves the model in either YAML format (= default and preferred, as all
   model content is reserved) and/or SBML format (= more widely compatible
   with other constraint-based modelling tools, can be used for running
   simulations like FBA etc., but this model cannot be loaded back into
   MATLAB for applying further GECKO functions, as model.ec is lost).

 Input:
   model           an ecModel in GECKO 3 format (with ecModel.ec structure)
   modelAdapter    a loaded model adapter, from where the model folder is
                   read (Optional, will otherwise use the default model adapter).
   format          file format, either as string if the model should be
                   saved in one format, e.g. 'yaml', or cell array if
                   multiple formats {'yaml','sbml'}. (Optional, default
                   'yaml').
   filename        file name, 'ecModel' by default.

 Usage:
   saveECmodel(model,modelAdapter,format,filename)</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function saveECmodel(model,modelAdapter,format,filename)</a>
0002 <span class="comment">% saveECmodel</span>
0003 <span class="comment">%   Saves the model in either YAML format (= default and preferred, as all</span>
0004 <span class="comment">%   model content is reserved) and/or SBML format (= more widely compatible</span>
0005 <span class="comment">%   with other constraint-based modelling tools, can be used for running</span>
0006 <span class="comment">%   simulations like FBA etc., but this model cannot be loaded back into</span>
0007 <span class="comment">%   MATLAB for applying further GECKO functions, as model.ec is lost).</span>
0008 <span class="comment">%</span>
0009 <span class="comment">% Input:</span>
0010 <span class="comment">%   model           an ecModel in GECKO 3 format (with ecModel.ec structure)</span>
0011 <span class="comment">%   modelAdapter    a loaded model adapter, from where the model folder is</span>
0012 <span class="comment">%                   read (Optional, will otherwise use the default model adapter).</span>
0013 <span class="comment">%   format          file format, either as string if the model should be</span>
0014 <span class="comment">%                   saved in one format, e.g. 'yaml', or cell array if</span>
0015 <span class="comment">%                   multiple formats {'yaml','sbml'}. (Optional, default</span>
0016 <span class="comment">%                   'yaml').</span>
0017 <span class="comment">%   filename        file name, 'ecModel' by default.</span>
0018 <span class="comment">%</span>
0019 <span class="comment">% Usage:</span>
0020 <span class="comment">%   saveECmodel(model,modelAdapter,format,filename)</span>
0021 
0022 
0023 <span class="keyword">if</span> nargin &lt; 2 || isempty(modelAdapter)
0024     modelAdapter = ModelAdapterManager.getDefault();
0025     <span class="keyword">if</span> isempty(modelAdapter)
0026         error(<span class="string">'Either send in a modelAdapter or set the default model adapter in the ModelAdapterManager.'</span>)
0027     <span class="keyword">end</span>
0028 <span class="keyword">end</span>
0029 params = modelAdapter.getParameters();
0030 <span class="keyword">if</span> nargin &lt; 3 || isempty(format)
0031     format = <span class="string">'yaml'</span>;
0032 <span class="keyword">end</span>
0033 <span class="keyword">if</span> nargin &lt; 4 || isempty (format)
0034     filename = <span class="string">'ecModel'</span>;
0035 <span class="keyword">end</span>
0036 filename = fullfile(params.path,<span class="string">'models'</span>,filename);
0037 
0038 <span class="comment">%Model description:</span>
0039 model.description = [<span class="string">'Enzyme-constrained model of '</span> model.id];
0040 
0041 <span class="keyword">if</span> contains(format,{<span class="string">'yaml'</span>,<span class="string">'yml'</span>})
0042     writeYAMLmodel(model,[filename <span class="string">'.yml'</span>]);
0043 <span class="keyword">end</span>
0044 
0045 <span class="keyword">if</span> contains(format,{<span class="string">'xml'</span>,<span class="string">'sbml'</span>})
0046     exportModel(model,[filename <span class="string">'.xml'</span>]);
0047     <span class="comment">%Convert notation &quot;e-005&quot; to &quot;e-05 &quot; in stoich. coeffs. to avoid</span>
0048     <span class="comment">%inconsistencies between Windows and MAC:</span>
0049     copyfile([filename <span class="string">'.xml'</span>],<span class="string">'backup.xml'</span>)
0050     fin  = fopen(<span class="string">'backup.xml'</span>, <span class="string">'r'</span>);
0051     fout = fopen([filename <span class="string">'.xml'</span>], <span class="string">'w'</span>);
0052     still_reading = true;
0053     <span class="keyword">while</span> still_reading
0054         inline = fgets(fin);
0055         <span class="keyword">if</span> ~ischar(inline)
0056             still_reading = false;
0057         <span class="keyword">else</span>
0058             <span class="keyword">if</span> ~isempty(regexp(inline,<span class="string">'-00[0-9]'</span>,<span class="string">'once'</span>))
0059                 inline = strrep(inline,<span class="string">'-00'</span>,<span class="string">'-0'</span>);
0060             <span class="keyword">elseif</span> ~isempty(regexp(inline,<span class="string">'-01[0-9]'</span>,<span class="string">'once'</span>))
0061                 inline = strrep(inline,<span class="string">'-01'</span>,<span class="string">'-1'</span>);
0062             <span class="keyword">end</span>
0063             fwrite(fout, inline);
0064         <span class="keyword">end</span>
0065     <span class="keyword">end</span>
0066     fclose(<span class="string">'all'</span>);
0067     delete(<span class="string">'backup.xml'</span>);
0068 <span class="keyword">end</span>
0069 <span class="keyword">end</span></pre></div>
<hr><address>Generated by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>