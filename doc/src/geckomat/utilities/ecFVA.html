<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of ecFVA</title>
  <meta name="keywords" content="ecFVA">
  <meta name="description" content="ecFVA">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../index.html">Home</a> &gt;  <a href="#">src</a> &gt; <a href="#">geckomat</a> &gt; <a href="index.html">utilities</a> &gt; ecFVA.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../index.html"><img alt="<" border="0" src="../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for src/geckomat/utilities&nbsp;<img alt=">" border="0" src="../../../right.png"></a></td></tr></table>-->

<h1>ecFVA
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>ecFVA</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function [minFlux, maxFlux] = ecFVA(ecModel, model) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> ecFVA
   Flux variability analysis is performed on the ecModel, and isoenzymic
   reactions are combined to construct ouput minFlux and maxFlux vectors,
   which follow the same order of model.rxns. The output from this
   function does not include enzyme usage reactions, to observe these, on
   could consider running flux variability directly on the ecModel.

 Input:
   ecModel     an ecModel in GECKO 3 format (with ecModel.ec structure)
   model       non-ecModel variant of the ecModel, to which the minFlux
               and maxFlux will be mapped
 Output:
   minFlux     vector of minimum flux rates, corresponding to model.rxns
   maxFlux     vector of maximum flux rates, corresponding to model.rxns

 Usage: [minFlux, maxFlux] = ecFVA(ecModel, model)</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="mapRxnsToConv.html" class="code" title="function [mappedFlux, enzUsageFlux, usageEnz] = mapRxnsToConv(ecModel, model, fluxVect)">mapRxnsToConv</a>	mapRxnsToConv</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function nUpdateWaitbar(~)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [minFlux, maxFlux] = ecFVA(ecModel, model)</a>
0002 <span class="comment">% ecFVA</span>
0003 <span class="comment">%   Flux variability analysis is performed on the ecModel, and isoenzymic</span>
0004 <span class="comment">%   reactions are combined to construct ouput minFlux and maxFlux vectors,</span>
0005 <span class="comment">%   which follow the same order of model.rxns. The output from this</span>
0006 <span class="comment">%   function does not include enzyme usage reactions, to observe these, on</span>
0007 <span class="comment">%   could consider running flux variability directly on the ecModel.</span>
0008 <span class="comment">%</span>
0009 <span class="comment">% Input:</span>
0010 <span class="comment">%   ecModel     an ecModel in GECKO 3 format (with ecModel.ec structure)</span>
0011 <span class="comment">%   model       non-ecModel variant of the ecModel, to which the minFlux</span>
0012 <span class="comment">%               and maxFlux will be mapped</span>
0013 <span class="comment">% Output:</span>
0014 <span class="comment">%   minFlux     vector of minimum flux rates, corresponding to model.rxns</span>
0015 <span class="comment">%   maxFlux     vector of maximum flux rates, corresponding to model.rxns</span>
0016 <span class="comment">%</span>
0017 <span class="comment">% Usage: [minFlux, maxFlux] = ecFVA(ecModel, model)</span>
0018 
0019 rxnIDs = regexprep(ecModel.rxns,<span class="string">'(_REV)?(_EXP_\d+)?'</span>,<span class="string">''</span>);
0020 [rxnIDmap, convRxnID] = findgroups(rxnIDs);
0021 
0022 solMaxAll = zeros(numel(ecModel.rxns),numel(convRxnID));
0023 solMinAll = solMaxAll;
0024 
0025 D = parallel.pool.DataQueue;
0026 h = waitbar(0, <span class="string">'Please wait ...'</span>);
0027 afterEach(D, @<a href="#_sub1" class="code" title="subfunction nUpdateWaitbar(~)">nUpdateWaitbar</a>);
0028 
0029 N = numel(rxnIDmap);
0030 p = 1;
0031 
0032 parfor i=1:N
0033     tmpModel = ecModel;
0034     tmpModel.c = zeros(numel(tmpModel.rxns),1);
0035 
0036     rxnsToOptim = find(rxnIDmap == i);
0037     rxnsOptIDs  = ecModel.rxns(rxnsToOptim);
0038     rxnsToMin = endsWith(rxnsOptIDs,<span class="string">'_REV'</span>) | contains(rxnsOptIDs,<span class="string">'_REV_EXP_'</span>);
0039     rxnsToMax = rxnsToOptim(~rxnsToMin);
0040     rxnsToMin = rxnsToOptim(rxnsToMin);
0041 
0042     tmpModel.c(rxnsToMax) = 1;
0043     tmpModel.c(rxnsToMin) = -1;
0044     solMax=solveLP(tmpModel);
0045     solMaxAll(:,i)=solMax.x;
0046     tmpModel.c(rxnsToMax) = -1;
0047     tmpModel.c(rxnsToMin) = 1;
0048     solMin=solveLP(tmpModel);
0049     solMinAll(:,i)=solMin.x;
0050     send(D, i);
0051 <span class="keyword">end</span>
0052 
0053 minFlux=min(solMinAll,[],2);
0054 maxFlux=max(solMaxAll,[],2);
0055 
0056 mappedFlux = <a href="mapRxnsToConv.html" class="code" title="function [mappedFlux, enzUsageFlux, usageEnz] = mapRxnsToConv(ecModel, model, fluxVect)">mapRxnsToConv</a>(ecModel,model,[minFlux maxFlux]);
0057 
0058 minFlux=mappedFlux(:,1);
0059 maxFlux=mappedFlux(:,2);
0060 close(h)
0061 
0062 <a name="_sub1" href="#_subfunctions" class="code">function nUpdateWaitbar(~)</a>
0063 waitbar(p/N, h);
0064 p = p + 1;
0065 <span class="keyword">end</span>
0066 <span class="keyword">end</span>
0067 
0068</pre></div>
<hr><address>Generated by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>