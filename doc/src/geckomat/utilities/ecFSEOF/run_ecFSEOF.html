<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of run_ecFSEOF</title>
  <meta name="keywords" content="run_ecFSEOF">
  <meta name="description" content="run_ecFSEOF">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../../index.html">Home</a> &gt;  <a href="#">src</a> &gt; <a href="#">geckomat</a> &gt; <a href="../index.html">utilities</a> &gt; <a href="index.html">ecFSEOF</a> &gt; run_ecFSEOF.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../../index.html"><img alt="<" border="0" src="../../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for src\geckomat\utilities\ecFSEOF&nbsp;<img alt=">" border="0" src="../../../../right.png"></a></td></tr></table>-->

<h1>run_ecFSEOF
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="box"><strong>run_ecFSEOF</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="box"><strong>function results = run_ecFSEOF(ecModel,targetRxn,csRxn,alphaLims,nSteps,file_genes,file_rxns,modelAdapter) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="fragment"><pre class="comment">run_ecFSEOF

 Function that runs Flux-scanning with Enforced Objective Function
 for a specified production target.

 Input:
   ecModel         an ecModel in GECKO 3 format (with ecModel.ec structure).
   targetRxn       rxn ID for the production target reaction, a exchange
                   reaction is recommended.
   csRxn           rxn ID for the main carbon source uptake reaction.
   alphaLims       vector of Minimum and maximum biomass scalling factors for
                   enforced objective limits (e.g. [0.5 1]). Max value: 1.
   nSteps          number of steps for suboptimal objective in FSEOF.
                   (Optional, default 16)
   file_genes      file name for results output at the genes level.
                   (Optional, default output in the model-specific 'output'
                   sub-folder taken from modelAdapter,
                   e.g. GECKO/userData/ecYeastGEM/output/ecFSEOF_genes.tsv)
   file_rxns       file name for results output at the reactions level.
                   (Optional, default output in the model-specific 'output'
                   sub-folder taken from modelAdapter,
                   e.g. GECKO/userData/ecYeastGEM/output/ecFSEOF_rxns.tsv)
   modelAdapter    a loaded model adapter. (Optional, will otherwise use
                   the default model adapter)

 Usage:
   results = run_ecFSEOF(ecModel,targetRxn,csRxn,alphaLims)</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../../matlabicon.gif)">
<li><a href="ecFlux_scanning.html" class="code" title="function FC = ecFlux_scanning(ecModel,targetRxn,csRxn,alpha,tolerance,filterG)">ecFlux_scanning</a>	ecFlux_scanning</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function results = run_ecFSEOF(ecModel,targetRxn,csRxn,alphaLims,nSteps,file_genes,file_rxns,modelAdapter)</a>
0002 <span class="comment">%run_ecFSEOF</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% Function that runs Flux-scanning with Enforced Objective Function</span>
0005 <span class="comment">% for a specified production target.</span>
0006 <span class="comment">%</span>
0007 <span class="comment">% Input:</span>
0008 <span class="comment">%   ecModel         an ecModel in GECKO 3 format (with ecModel.ec structure).</span>
0009 <span class="comment">%   targetRxn       rxn ID for the production target reaction, a exchange</span>
0010 <span class="comment">%                   reaction is recommended.</span>
0011 <span class="comment">%   csRxn           rxn ID for the main carbon source uptake reaction.</span>
0012 <span class="comment">%   alphaLims       vector of Minimum and maximum biomass scalling factors for</span>
0013 <span class="comment">%                   enforced objective limits (e.g. [0.5 1]). Max value: 1.</span>
0014 <span class="comment">%   nSteps          number of steps for suboptimal objective in FSEOF.</span>
0015 <span class="comment">%                   (Optional, default 16)</span>
0016 <span class="comment">%   file_genes      file name for results output at the genes level.</span>
0017 <span class="comment">%                   (Optional, default output in the model-specific 'output'</span>
0018 <span class="comment">%                   sub-folder taken from modelAdapter,</span>
0019 <span class="comment">%                   e.g. GECKO/userData/ecYeastGEM/output/ecFSEOF_genes.tsv)</span>
0020 <span class="comment">%   file_rxns       file name for results output at the reactions level.</span>
0021 <span class="comment">%                   (Optional, default output in the model-specific 'output'</span>
0022 <span class="comment">%                   sub-folder taken from modelAdapter,</span>
0023 <span class="comment">%                   e.g. GECKO/userData/ecYeastGEM/output/ecFSEOF_rxns.tsv)</span>
0024 <span class="comment">%   modelAdapter    a loaded model adapter. (Optional, will otherwise use</span>
0025 <span class="comment">%                   the default model adapter)</span>
0026 <span class="comment">%</span>
0027 <span class="comment">% Usage:</span>
0028 <span class="comment">%   results = run_ecFSEOF(ecModel,targetRxn,csRxn,alphaLims)</span>
0029 <span class="comment">%</span>
0030 
0031 <span class="keyword">if</span> nargin &lt; 8 || isempty(modelAdapter)
0032     modelAdapter = ModelAdapterManager.getDefault();
0033     <span class="keyword">if</span> isempty(modelAdapter)
0034         error(<span class="string">'Either send in a modelAdapter or set the default model adapter in the ModelAdapterManager.'</span>)
0035     <span class="keyword">end</span>
0036 <span class="keyword">end</span>
0037 params = modelAdapter.getParameters();
0038 
0039 <span class="keyword">if</span> nargin &lt; 7 || isempty(file_rxns)
0040     file_rxns = fullfile(params.path,<span class="string">'output'</span>,<span class="string">'ecFSEOF_rxns.tsv'</span>);
0041 <span class="keyword">end</span>
0042 
0043 <span class="keyword">if</span> nargin &lt; 6 || isempty(file_genes)
0044     file_genes = fullfile(params.path,<span class="string">'output'</span>,<span class="string">'ecFSEOF_genes.tsv'</span>);
0045 <span class="keyword">end</span>
0046 
0047 <span class="keyword">if</span> nargin &lt; 5 || isempty(nSteps)
0048     nSteps = 16;
0049 <span class="keyword">end</span>
0050 
0051 <span class="keyword">if</span> numel(alphaLims) ~= 2
0052     error(<span class="string">'alphaLims parameter should be a vector of two values'</span>)
0053 <span class="keyword">end</span>
0054 
0055 <span class="comment">% Define alpha vector for suboptimal enforced objective values</span>
0056 alphaV  = alphaLims(1):((alphaLims(2)-alphaLims(1))/(nSteps-1)):alphaLims(2);
0057 
0058 <span class="comment">% Standardize grRules and rxnGeneMat in model</span>
0059 [grRules,rxnGeneMat] = standardizeGrRules(ecModel,true);
0060 ecModel.grRules      = grRules;
0061 ecModel.rxnGeneMat   = rxnGeneMat;
0062 
0063 <span class="comment">% run FSEOF analysis</span>
0064 results = <a href="ecFlux_scanning.html" class="code" title="function FC = ecFlux_scanning(ecModel,targetRxn,csRxn,alpha,tolerance,filterG)">ecFlux_scanning</a>(ecModel,targetRxn,csRxn,alphaV,1E-4,true);
0065 
0066 <span class="comment">% Create gene table:</span>
0067 results.geneTable      = cell(length(results.genes),3);
0068 results.geneTable(:,1) = results.genes;
0069 results.geneTable(:,2) = results.geneNames;
0070 results.geneTable(:,3) = num2cell(results.k_genes);
0071 
0072 <span class="comment">% Create rxns table (exclude enzyme usage reactions):</span>
0073 toKeep                 = find(~startsWith(results.rxns(:,1),<span class="string">'usage_prot_'</span>));
0074 results.k_rxns         = results.k_rxns(toKeep);
0075 results.k_matrix       = results.k_matrix(toKeep,:);
0076 results.v_matrix       = results.v_matrix(toKeep,:);
0077 results.rxnsTable      = cell(length(results.k_rxns),5);
0078 results.rxnsTable(:,1) = results.rxns(toKeep,1);
0079 results.rxnsTable(:,2) = results.rxns(toKeep,2);
0080 results.rxnsTable(:,3) = num2cell(results.k_rxns);
0081 results.rxnsTable(:,4) = results.rxns(toKeep,3);
0082 results.rxnsTable(:,5) = results.rxns(toKeep,4);
0083 
0084 writetable(cell2table(results.geneTable, <span class="keyword">...</span>
0085     <span class="string">'VariableNames'</span>, {<span class="string">'gene_IDs'</span> <span class="string">'gene_names'</span> <span class="string">'K_score'</span>}), <span class="keyword">...</span>
0086     file_genes, <span class="keyword">...</span>
0087     <span class="string">'FileType'</span>, <span class="string">'text'</span>, <span class="keyword">...</span>
0088     <span class="string">'Delimiter'</span>, <span class="string">'\t'</span>, <span class="keyword">...</span>
0089     <span class="string">'QuoteStrings'</span>, false);
0090 
0091 writetable(cell2table(results.rxnsTable, <span class="keyword">...</span>
0092     <span class="string">'VariableNames'</span>, {<span class="string">'rxn_IDs'</span> <span class="string">'rxnNames'</span> <span class="string">'K_score'</span> <span class="string">'grRules'</span> <span class="string">'rxn_formula'</span>}), <span class="keyword">...</span>
0093     file_rxns, <span class="keyword">...</span>
0094     <span class="string">'FileType'</span>, <span class="string">'text'</span>, <span class="keyword">...</span>
0095     <span class="string">'Delimiter'</span>, <span class="string">'\t'</span>, <span class="keyword">...</span>
0096     <span class="string">'QuoteStrings'</span>, false);
0097 
0098 disp([<span class="string">'ecFSEOF results stored at: '</span> newline fileparts(file_genes)]);
0099 
0100 <span class="comment">% Remove redundant output fields</span>
0101 results = rmfield(results,<span class="string">'k_rxns'</span>);
0102 results = rmfield(results,<span class="string">'rxns'</span>);
0103 results = rmfield(results,<span class="string">'genes'</span>);
0104 results = rmfield(results,<span class="string">'geneNames'</span>);
0105 results = rmfield(results,<span class="string">'k_genes'</span>);
0106 <span class="keyword">end</span></pre></div>
<hr><address>Generated by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>